/*!
 * OpenUI5
 * (c) Copyright 2009-2023 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["./ModificationHandler","sap/m/p13n/FlexUtil","sap/m/p13n/enum/PersistenceMode","sap/ui/core/Core"],function(n,t,e,i){"use strict";var r,o,a,u;var s=function(){if(!a){a=new Promise(function(n,t){sap.ui.require(["sap/ui/fl/apply/api/FlexRuntimeInfoAPI"],function(t){n(t)},t)})}return a};var f=function(){if(!u){u=new Promise(function(n,t){sap.ui.require(["sap/ui/fl/write/api/ControlPersonalizationWriteAPI"],function(t){n(t)})})}return u};var c=n.extend("sap.m.p13n.modification.FlexModificationHandler");c.prototype.processChanges=function(n,i){var r=n&&n[0]?n[0].selectorElement:undefined;var o=i.mode;var a=o===e.Auto;if(a){o=i.hasVM?"Standard":e.Global}var u=o===e.Global;var s=o===e.Transient;return this.initialize().then(function(){var e=t.handleChanges(n,u,s);return u?e.then(function(n){return t.saveChanges(r,n)}):e})};c.prototype.waitForChanges=function(n,t){return this.initialize().then(function(){return s().then(function(e){return e.waitForChanges(n,t)})})};c.prototype.hasChanges=function(n,t){return this.initialize().then(function(){return f().then(function(t){return t.hasDirtyFlexObjects(n)})})};c.prototype.reset=function(n,i){var r=i.mode;var o=r===e.Global;var a=!i.hasVM&&i.hasPP&&r===e.Auto;return this.initialize().then(function(){return o||a?t.reset(n):t.restore(n)})};c.prototype.isModificationSupported=function(n,t){return this.initialize().then(function(){return s().then(function(e){return e.isFlexSupported(n,t)})})};c.prototype.initialize=function(){if(!o){o=i.loadLibrary("sap.ui.fl",{async:true})}return o};c.getInstance=function(){if(!r){r=new c}return r};return c});
//# sourceMappingURL=FlexModificationHandler.js.map