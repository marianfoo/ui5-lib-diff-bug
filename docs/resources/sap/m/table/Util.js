/*!
 * OpenUI5
 * (c) Copyright 2009-2023 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/m/library","sap/ui/core/Core","sap/ui/core/Theming","sap/ui/core/theming/Parameters","sap/m/IllustratedMessage","sap/m/Button","sap/ui/core/InvisibleMessage"],function(e,t,a,r,n,i,o){"use strict";var u={};var s="";var l=parseFloat(e.BaseFontSize);var c=null;var m=null;u.measureText=function(){var e=.05;var t=document.createElement("canvas").getContext("2d");var n=function(){s=[parseFloat(r.get({name:"sapMFontMediumSize"})||"0.875rem")*l+"px",r.get({name:"sapUiFontFamily"})||"Arial"].join(" ");return s};a.attachApplied(n);return function(a,r){t.font=r||s||n();return t.measureText(a||"").width/l+e}}();u.calcTypeWidth=function(){var e=0;var r=[2023,9,26,22,47,58,999];var n=new Date(Date.UTC.apply(0,r));var i=new(Function.prototype.bind.apply(Date,[null].concat(r)));var o={Byte:3,SByte:3,Int16:5,Int32:9,Int64:12,Single:6,Float:12,Double:13,Decimal:15,Integer:9};a.attachApplied(function(){e=0});return function(a,r){var s=a.getMetadata().getName().split(".").pop();var l=r&&r.maxWidth||19;var c=r&&r.gap||0;var m=function(e){return Math.min(e+c,l)};if(s=="Boolean"){if(!e){var p=t.getLibraryResourceBundle("sap.ui.core");var d=u.measureText(p.getText("YES"));var v=u.measureText(p.getText("NO"));e=Math.max(d,v)}return m(e)}if(s=="String"||a.isA("sap.ui.model.odata.type.String")){var f=parseInt(a.getConstraints().maxLength)||0;if(!f||f*.25>l){return l}var T=u.measureText("A".repeat(f));if(f<l||l<10){return m(T)}var g=Math.log(T-l*.16)/Math.log(l/3)*(l/2)*Math.pow(l/19,1/T);return m(Math.min(g,T))}if(s.startsWith("Date")||s.startsWith("Time")){var h=a.getFormatOptions();var x=h.UTC?n:i;var M=x.toLocaleDateString();if(s=="TimeOfDay"){M=new Intl.DateTimeFormat("de",{hour:"numeric",minute:"numeric",second:"numeric"}).format(x);M=a.formatValue(M,"string")}else if(a.isA("sap.ui.model.odata.type.Time")){M=a.formatValue({__edmType:"Edm.Time",ms:n.valueOf()},"string")}else{M=a.formatValue(h.interval?[x,new Date(x*1.009)]:x,"string");(a.oFormat&&a.oFormat.oFormatOptions&&a.oFormat.oFormatOptions.pattern||"").replace(/[MELVec]{3,4}/,function(e){M+=e.length==4?"---":"-"})}return m(u.measureText(M))}if(o[s]){var A=parseInt(a.getConstraints().scale)||0;var E=parseInt(a.getConstraints().precision)||20;E=Math.min(E,o[s]);var L=2*Math.pow(10,E-A-1);L=a.formatValue(L,"string");return m(u.measureText(L))}return r&&r.defaultWidth||8}}();u.calcHeaderWidth=function(){var e="";var t="";var n=function(){if(!e){e=[r.get({name:"sapUiColumnHeaderFontWeight"})||"normal",s].join(" ")}return e};var i=function(){if(!t){t=[r.get({name:"sapMFontLargeSize"})||"normal",s].join(" ")}return t};a.attachApplied(function(){e="";t=""});return function(e,t,a,r,o){var s=e.length;var l=0;a=a||19;r=r||2;if(t>a){return a}if(r>s){return r}if(o){l=.125+u.measureText("*",i())}if(!t){var c=u.measureText(e,n());return c+l}t=Math.max(t,r);if(t>s){return t}var m=u.measureText(e,n());m=Math.min(m,a*.7);var p=Math.max(1,1-Math.log(Math.max(t-1.7,.2))/Math.log(a*.5)+1);var d=p*t;var v=Math.max(0,m-d);var c=v<.15?m:d+v*(1-1/t)/Math.E;return c+l}}();u.calcColumnWidth=function(e,t,a){if(!Array.isArray(e)){e=[e]}a=Object.assign({minWidth:2,maxWidth:19,defaultWidth:8,truncateLabel:true,padding:1.0625,gap:0},a);var r=0;var n=Math.max(1,a.minWidth);var i=Math.max(n,a.maxWidth);var o=a.treeColumn?3:0;var s=a.gap+o+e.reduce(function(e,t){var r=t,n={defaultWidth:a.defaultWidth,maxWidth:a.maxWidth};if(Array.isArray(t)){r=t[0];n=t[1]||n}var i=u.calcTypeWidth(r,n);return a.verticalArrangement?Math.max(e,i):e+i+(e&&.5)},0);if(t){r=u.calcHeaderWidth(t,a.truncateLabel?s:0,i,n,a.required);r+=a.headerGap?(8+14)/l:0}s=Math.max(n,s,r);s=Math.min(s,i);s=Math.ceil(s*100)/100;return s+a.padding+"rem"};u.getNoColumnsIllustratedMessage=function(a){var r=t.getLibraryResourceBundle("sap.m");var o=new n({illustrationType:e.IllustratedMessageType.AddColumn,title:r.getText("TABLE_NO_COLUMNS_TITLE"),description:r.getText("TABLE_NO_COLUMNS_DESCRIPTION")});if(a){var u=new i({icon:"sap-icon://action-settings",press:a});o.addAdditionalContent(u)}return o};u.getSelectAllPopover=function(){if(m){return m}m=Promise.all([new Promise(function(e){sap.ui.require(["sap/m/Popover","sap/m/Bar","sap/m/HBox","sap/m/Title","sap/ui/core/library","sap/m/Text"],function(t,a,r,n,i,o){e({Popover:t,Bar:a,HBox:r,Title:n,coreLib:i,Text:o})})}),t.getLibraryResourceBundle("sap.m",true)]).then(function(e){var t=e[0];var a=e[1];var r=t.coreLib.IconColor.Critical,n=t.coreLib.TitleLevel.H2;c=new t.Popover({customHeader:new t.Bar({contentMiddle:[new t.HBox({items:[new t.coreLib.Icon({src:"sap-icon://message-warning",color:r}).addStyleClass("sapUiTinyMarginEnd"),new t.Title({text:a.getText("TABLE_SELECT_LIMIT_TITLE"),level:n})],renderType:"Bare",justifyContent:"Center",alignItems:"Center"})]}),content:[new t.Text]}).addStyleClass("sapUiContentPadding");return{oSelectAllNotificationPopover:c,oResourceBundle:a}});return m};u.showSelectionLimitPopover=function(e,t){u.getSelectAllPopover().then(function(a){var r=a.oSelectAllNotificationPopover;var n=a.oResourceBundle;var i=n.getText("TABLE_SELECT_LIMIT",[e]);r.getContent()[0].setText(i);if(t){r.openBy(t)}})};u.hideSelectionLimitPopover=function(){if(c&&c.isOpen()){c.close()}};u.announceTableUpdate=function(e,a){var r=o.getInstance();if(r){var n=t.getLibraryResourceBundle("sap.m");if(a==undefined){r.announce(n.getText("table.ANNOUNCEMENT_TABLE_UPDATED",[e]))}else if(a>1){r.announce(n.getText("table.ANNOUNCEMENT_TABLE_UPDATED_MULT",[e,a]))}else if(a===1){r.announce(n.getText("table.ANNOUNCEMENT_TABLE_UPDATED_SING",[e,a]))}else{r.announce(n.getText("table.ANNOUNCEMENT_TABLE_UPDATED_NOITEMS",[e]))}}};u.isEmpty=function(e){if(!e){return true}var t=e.getLength();if(t===1&&e.isA("sap.ui.model.analytics.AnalyticalBinding")){var a=e?e.providesGrandTotal()&&e.hasTotaledMeasures():false;if(a){t=0}}return t<=0};return u});
//# sourceMappingURL=Util.js.map